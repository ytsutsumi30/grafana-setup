# ç”Ÿç”£ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ çµ±åˆç’°å¢ƒ

WSLä¸Šã®Dockerç’°å¢ƒã§å‹•ä½œã™ã‚‹çµ±åˆç”Ÿç”£ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚å‡ºè·æ¤œå“ã¾ã§ã®å…¨å·¥ç¨‹ã‚’ç®¡ç†ã—ã€PostgreSQLã¨Grafanaã«ã‚ˆã‚‹é«˜åº¦ãªåˆ†ææ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚

## ğŸŒŸ ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

### ä¸»è¦æ©Ÿèƒ½
- **ç”Ÿç”£ç®¡ç†**: ç”Ÿç”£è¨ˆç”»ã‹ã‚‰å®Ÿç¸¾ç®¡ç†ã¾ã§
- **å‡ºè·ç®¡ç†**: å‡ºè·æŒ‡ç¤ºã®ç®¡ç†ã¨è¿½è·¡
- **å‡ºè·æ¤œå“**: å“è³ªç®¡ç†ã¨æœ€çµ‚æ¤œæŸ»
- **åœ¨åº«ç®¡ç†**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åœ¨åº«çŠ¶æ³
- **ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**: KPIç›£è¦–ã¨åˆ†æ
- **ãƒ¬ãƒãƒ¼ãƒˆ**: Grafanaã«ã‚ˆã‚‹é«˜åº¦ãªåˆ†æ

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
- **Frontend**: HTML5, CSS3, JavaScript (Bootstrap 5)
- **Backend**: Node.js (Express)
- **Database**: PostgreSQL 15
- **Analytics**: Grafana + Prometheus
- **Reverse Proxy**: nginx
- **Container**: Docker + Docker Compose

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### 1. å‰ææ¡ä»¶
- WSL2 (Ubuntu 22.04æ¨å¥¨)
- Docker & Docker Compose
- curl (ã‚µãƒ¼ãƒ“ã‚¹ç¢ºèªç”¨)

### 2. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```bash
# ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³ï¼ˆä»®æƒ³ç’°å¢ƒï¼‰
cd /tmp/grafana-setup

# å®Ÿè¡Œæ¨©é™ä»˜ä¸
chmod +x manage.sh

# ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•
./manage.sh start
```

### 3. ã‚¢ã‚¯ã‚»ã‚¹
ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•å¾Œã€ä»¥ä¸‹ã®URLã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ï¼š

| ã‚µãƒ¼ãƒ“ã‚¹ | URL | èªè¨¼æƒ…å ± |
|---------|-----|----------|
| ğŸ  ç”Ÿç”£ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  | http://localhost | - |
| ğŸ” å‡ºè·æ¤œå“ã‚·ã‚¹ãƒ†ãƒ  | http://localhost/shipping-inspection-mockup.html | - |
| ğŸ“Š Grafana | http://localhost/grafana/ | admin/admin123 |
| ğŸ“ˆ Prometheus | http://localhost/prometheus/ | - |
| ğŸ› ï¸ API | http://localhost/api/health | - |

## ğŸ“ ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ

```
grafana-setup/
â”œâ”€â”€ docker-compose.yml          # Docker Composeè¨­å®š
â”œâ”€â”€ .env                       # ç’°å¢ƒå¤‰æ•°
â”œâ”€â”€ manage.sh                  # ç®¡ç†ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ README.md                  # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
â”‚
â”œâ”€â”€ nginx/                     # nginxè¨­å®š
â”‚   â”œâ”€â”€ nginx.conf
â”‚   â””â”€â”€ conf.d/default.conf
â”‚
â”œâ”€â”€ postgres/                  # PostgreSQLè¨­å®š
â”‚   â””â”€â”€ init/01-init.sql       # DBåˆæœŸåŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚
â”œâ”€â”€ api/                       # Node.js APIã‚µãƒ¼ãƒãƒ¼
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ server.js
â”‚
â”œâ”€â”€ web/                       # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
â”‚   â”œâ”€â”€ index.html             # ãƒ¡ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ 
â”‚   â”œâ”€â”€ shipping-inspection-mockup.html  # å‡ºè·æ¤œå“
â”‚   â”œâ”€â”€ styles.css
â”‚   â””â”€â”€ app.js
â”‚
â””â”€â”€ grafana/                   # Grafanaè¨­å®š
    â””â”€â”€ provisioning/
        â””â”€â”€ datasources/
            â””â”€â”€ datasources.yml
```

## ğŸ› ï¸ ç®¡ç†ã‚³ãƒãƒ³ãƒ‰

```bash
# ã‚·ã‚¹ãƒ†ãƒ æ“ä½œ
./manage.sh start      # ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•
./manage.sh stop       # ã‚·ã‚¹ãƒ†ãƒ åœæ­¢
./manage.sh restart    # ã‚·ã‚¹ãƒ†ãƒ å†èµ·å‹•

# ç›£è¦–ãƒ»ç¢ºèª
./manage.sh status     # ã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ³ç¢ºèª
./manage.sh logs       # ãƒ­ã‚°è¡¨ç¤º

# ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹
./manage.sh backup     # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
./manage.sh clean      # å®Œå…¨ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ï¼ˆãƒ‡ãƒ¼ã‚¿å‰Šé™¤ï¼‰

# ãƒ˜ãƒ«ãƒ—
./manage.sh help       # å…¨ã‚³ãƒãƒ³ãƒ‰è¡¨ç¤º
```

## ğŸ“Š ã‚·ã‚¹ãƒ†ãƒ åˆ©ç”¨æ–¹æ³•

### ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
- ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®KPIè¡¨ç¤º
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çµ±è¨ˆæƒ…å ±
- æœ€è¿‘ã®æ´»å‹•å±¥æ­´

### å‡ºè·ç®¡ç†
- å‡ºè·æŒ‡ç¤ºä¸€è¦§è¡¨ç¤º
- å„ªå…ˆåº¦ãƒ»ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç®¡ç†
- é¡§å®¢åˆ¥é…é€ç®¡ç†

### å‡ºè·æ¤œå“
- æ¤œå“é …ç›®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
- æ•°é‡ãƒ»å“è³ªç¢ºèª
- æœ€çµ‚æ‰¿èªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
- ãƒãƒ¼ã‚³ãƒ¼ãƒ‰è¡¨ç¤º

### åœ¨åº«ç®¡ç†
- è£½å“åˆ¥åœ¨åº«çŠ¶æ³
- åˆ©ç”¨å¯èƒ½åœ¨åº«è¨ˆç®—
- ä½åœ¨åº«ã‚¢ãƒ©ãƒ¼ãƒˆ

### åˆ†æãƒ»ãƒ¬ãƒãƒ¼ãƒˆ
- Grafanaãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
- PostgreSQLã‚¯ã‚¨ãƒªå®Ÿè¡Œ
- ã‚«ã‚¹ã‚¿ãƒ ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ

## ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

### ä¸»è¦ãƒ†ãƒ¼ãƒ–ãƒ«
- `products`: è£½å“ãƒã‚¹ã‚¿
- `production_plans`: ç”Ÿç”£è¨ˆç”»
- `production_records`: ç”Ÿç”£å®Ÿç¸¾
- `shipping_instructions`: å‡ºè·æŒ‡ç¤º
- `shipping_inspections`: å‡ºè·æ¤œå“
- `inventory`: åœ¨åº«ç®¡ç†

### ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿
åˆæœŸåŒ–æ™‚ã«ä»¥ä¸‹ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ãŒæŠ•å…¥ã•ã‚Œã¾ã™ï¼š
- è£½å“ãƒã‚¹ã‚¿: 5è£½å“
- ç”Ÿç”£è¨ˆç”»: 3è¨ˆç”»
- å‡ºè·æŒ‡ç¤º: 3æŒ‡ç¤º
- åœ¨åº«ãƒ‡ãƒ¼ã‚¿: 5è£½å“åˆ†

## ğŸ”§ ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### ç’°å¢ƒå¤‰æ•°ã®å¤‰æ›´
`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã—ã¦ã‚·ã‚¹ãƒ†ãƒ è¨­å®šã‚’å¤‰æ›´ï¼š

```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­å®š
POSTGRES_PASSWORD=production_pass  # ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´

# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š
JWT_SECRET=your-new-secret-key     # JWTç§˜å¯†éµ

# ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«
LOG_LEVEL=debug                    # ãƒ‡ãƒãƒƒã‚°ãƒ¬ãƒ™ãƒ«
```

### ãƒãƒ¼ãƒˆç•ªå·ã®å¤‰æ›´
nginxè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ï¼š
```bash
vi nginx/conf.d/default.conf
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã®å¤‰æ›´
```bash
vi postgres/init/01-init.sql
```

## ğŸ” ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

**Docker ãŒèµ·å‹•ã—ãªã„**
```bash
# Docker ã‚µãƒ¼ãƒ“ã‚¹ç¢ºèªãƒ»èµ·å‹•
sudo service docker status
sudo service docker start
```

**ãƒãƒ¼ãƒˆãŒæ—¢ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹**
```bash
# ãƒãƒ¼ãƒˆä½¿ç”¨çŠ¶æ³ç¢ºèª
sudo netstat -tlnp | grep :80

# .envãƒ•ã‚¡ã‚¤ãƒ«ã§ãƒãƒ¼ãƒˆå¤‰æ›´
HTTP_PORT=8080
```

**ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼**
```bash
# PostgreSQLçŠ¶æ³ç¢ºèª
./manage.sh status

# ã‚³ãƒ³ãƒ†ãƒŠå†èµ·å‹•
docker-compose restart postgres
```

**APIæ¥ç¶šã‚¨ãƒ©ãƒ¼**
```bash
# APIã‚µãƒ¼ãƒãƒ¼ãƒ­ã‚°ç¢ºèª
docker-compose logs production-api

# ä¾å­˜é–¢ä¿‚ç¢ºèª
docker-compose exec production-api npm list
```

### ãƒ­ã‚°ç¢ºèª
```bash
# å…¨ã‚µãƒ¼ãƒ“ã‚¹ãƒ­ã‚°
./manage.sh logs

# ç‰¹å®šã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ­ã‚°
docker-compose logs nginx
docker-compose logs postgres
docker-compose logs production-api
```

### ãƒ‡ãƒ¼ã‚¿ãƒªã‚»ãƒƒãƒˆ
```bash
# å®Œå…¨ãƒªã‚»ãƒƒãƒˆï¼ˆãƒ‡ãƒ¼ã‚¿å‰Šé™¤ï¼‰
./manage.sh clean

# ã‚·ã‚¹ãƒ†ãƒ å†æ§‹ç¯‰
./manage.sh start
```

## ğŸ’¾ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»å¾©å…ƒ

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
```bash
# è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
./manage.sh backup

# æ‰‹å‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
docker-compose exec postgres pg_dump -U production_user production_db > backup.sql
```

### ãƒ‡ãƒ¼ã‚¿å¾©å…ƒ
```bash
# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å¾©å…ƒ
docker-compose exec -T postgres psql -U production_user -d production_db < backup.sql
```

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

### æœ¬ç•ªç’°å¢ƒã§ã®æ³¨æ„äº‹é …
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®å¤‰æ›´
- HTTPSè¨­å®šã®æœ‰åŠ¹åŒ–
- ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®š
- ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã®ç›£è¦–
- å®šæœŸçš„ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ

### SSL/TLSè¨­å®š
```bash
# SSLè¨¼æ˜æ›¸é…ç½®
mkdir -p ssl/
# è¨¼æ˜æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ssl/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®
```

## ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æœ€é©åŒ–
- æ¥ç¶šãƒ—ãƒ¼ãƒ«è¨­å®š
- ã‚¯ã‚¨ãƒªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–

### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
- Node.jsãƒ¡ãƒ¢ãƒªåˆ¶é™èª¿æ•´
- nginx ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­å®š
- ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³

## ğŸ¤ é–‹ç™ºãƒ»æ‹¡å¼µ

### APIé–‹ç™º
- RESTful APIè¨­è¨ˆ
- OpenAPI/Swaggeræ–‡æ›¸
- å˜ä½“ãƒ†ã‚¹ãƒˆä½œæˆ

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æ‹¡å¼µ
- æ–°æ©Ÿèƒ½ç”»é¢è¿½åŠ 
- ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³æ”¹å–„
- PWAåŒ–å¯¾å¿œ

### ãƒ‡ãƒ¼ã‚¿åˆ†ææ‹¡å¼µ
- Grafanaãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¿½åŠ 
- ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹å®Ÿè£…
- ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š

## ğŸ“ ã‚µãƒãƒ¼ãƒˆ

### ã‚·ã‚¹ãƒ†ãƒ è¦ä»¶
- CPU: 2ã‚³ã‚¢ä»¥ä¸Š
- ãƒ¡ãƒ¢ãƒª: 4GBä»¥ä¸Š
- ãƒ‡ã‚£ã‚¹ã‚¯: 10GBä»¥ä¸Š
- OS: Ubuntu 20.04/22.04 LTS

### æ›´æ–°å±¥æ­´
- v1.0.0: åˆæœŸãƒªãƒªãƒ¼ã‚¹ - åŸºæœ¬çš„ãªç”Ÿç”£ç®¡ç†æ©Ÿèƒ½
- v1.1.0: å‡ºè·æ¤œå“ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ
- v1.2.0: PostgreSQLç§»è¡Œãƒ»Grafanaçµ±åˆ

---

**æ³¨æ„**: æœ¬ã‚·ã‚¹ãƒ†ãƒ ã¯é–‹ç™ºãƒ»æ¤œè¨¼ç’°å¢ƒå‘ã‘ã§ã™ã€‚æœ¬ç•ªç’°å¢ƒã§ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€é©åˆ‡ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šã¨ç›£è¦–ä½“åˆ¶ã‚’æ•´å‚™ã—ã¦ãã ã•ã„ã€‚
